webpackJsonp([9],{LtSj:function(t,e,s){var a=s("bk6T");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);s("rjj0")("5a2572cc",a,!0)},WZjT:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("woOf"),r=s.n(a),o=s("Dd8w"),i=s.n(o),n=s("BO1k"),l=s.n(n),c=s("Z/wl"),u={data:function(){return{editRole:{roleId:null},secShow:!1,dialogStatus:"",citys:c.a,cascaderProps:{value:"name",label:"name"},showStalls:!1,showBusiness:!0,props:{value:"id",label:"name",children:"children"},secTitle:"",options:[],isFirstShow:!0,defaultOptions:[{name:"",id:""}],textMap:{update:"编辑用户",create:"创建用户"},filters:{userName:"",phone:""},users:[],stallList:[],total:0,pageNum:1,pageSize:10,totalFloor:0,pageNumFloor:1,pageSizeFloor:10,sels:[],showDrawer:!1,editFormRules:{categoryId:[{required:!0,validator:this.noEmptyArr,message:"请选择分类",trigger:"blur"}],orderNum:[{required:!0,validator:this.mustNumber,message:"分类序号需为数字",trigger:"blur"}],img:[{required:!0,validator:this.noEmpty,message:"分类图片不能为空",trigger:"blur"}]},businessFormRules:{name:[{required:!0,validator:this.noEmpty,message:"请输入一级分类名称",trigger:"blur"},{required:!0,validator:this.lessThan10,message:"一级分类名称不超过10个字符",trigger:"blur"},{required:!0,validator:this.noOther,message:"一级分类名称不能为'其他'",trigger:"blur"}],orderNum:[{required:!0,validator:this.mustNumber,message:"分类序号需为有效数字",trigger:"blur"}]},businessForm:{name:"",orderNum:"",status:1},editForm:{name:"",orderNum:"",img:"",status:1,categoryId:[]},parentCategory:{},ids:[],selectArr:[],addFormVisible:!1}},created:function(){this.init()},methods:{init:function(){this.getUsers()},formatCreateTime:function(t){return this._formatTime(t.updateTime)},formatStatus:function(t){return 1===t.status?"开启":"禁用"},formatFloorStatus:function(t){return"2"===t.status?"开启":"禁用"},handleCurrentChange:function(t){this.pageNum=t,this.getUsers()},handleCurrentChangeFloor:function(t){this.pageNumFloor=t,this.getFloors()},disabledArea:function(t){var e=this;if(1===t.status){var s=this;this.$confirm("确定禁用该一级分类吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$postJson(e._basePath.ajaxCategoryOperateStatus1,{id:t.id,status:0}).then(function(t){t.success&&(e.$message.success("禁用成功！"),s.getUsers())})})}else this.$postJson(this._basePath.ajaxCategoryOperateStatus1,{id:t.id,status:1}).then(function(t){t.success&&(e.$message.success("启用成功！"),e.getUsers())})},setImgList:function(t){this.$set(this.editForm,"img",t[0])},noOther:function(t,e,s){e&&"其它"!==e?s():s(new Error(t.message))},getCategory1:function(){var t=this;this.isFirstShow&&this.$get(this._basePath.ajaxCategoryOperationCategory1).then(function(e){if(e.success){var s=[],a=!0,r=!1,o=void 0;try{for(var i,n=l()(e.data);!(a=(i=n.next()).done);a=!0){var c=i.value;!c.isChildren&&(c.children=[]),s.push(c)}}catch(t){r=!0,o=t}finally{try{!a&&n.return&&n.return()}finally{if(r)throw o}}t.options=s,t.isFirstShow=!1}})},getCategory2:function(t){var e=this,s=this.options.find(function(e){return e.id===t[0]});s.isChildren||0!==s.children.length||this.$postJson(this._basePath.ajaxCategoryOperationCategory2,{parentId:t[t.length-1]}).then(function(s){if(s.success){var a=e.iteratorCascader(t[t.length-1],e.options);if(!s.data.length)return!0;!a.isChildren&&(a.children=[]),e.$set(a,"children",s.data)}})},iteratorCascader:function(t,e){var s={};return function t(e,a){var r=!0,o=!1,i=void 0;try{for(var n,c=l()(a);!(r=(n=c.next()).done);r=!0){var u=n.value;u.id===e&&(s=u),u.children&&t(e,u.children)}}catch(t){o=!0,i=t}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}}(t,e),s},showAddStall:function(){this.isFirstShow=!0,this.showDrawer=!0,this.editForm={name:"",orderNum:"",img:"",status:1,categoryId:[]}},getUsers:function(){var t=this,e={pageNum:this.pageNum,pageSize:this.pageSize},s=this.filters;this.$postJson(this._basePath.ajaxCategoryByPage,i()({},e,s)).then(function(e){e.success&&(t.total=e.data.count,t.users=e.data.datas)})},showAddBusiness:function(){this.secShow=!0,this.showBusiness=!0,this.showStalls=!1,this.secTitle="编辑一级分类",this.businessForm={name:"",orderNum:"",status:1}},getBusinessDetail:function(t){this.secShow=!0,this.secTitle="编辑一级分类",this.showStalls=!1,this.showBusiness=!0,this.businessForm=r()({},t)},tradeAreaEdit:function(){var t=this;this.$refs.businessForm.validate(function(e){if(e){var s=r()({},t.businessForm);t.$post(t._basePath.ajaxCategoryEdit,s).then(function(e){e.success&&(t.$message.success("操作成功"),t.getUsers(),t.secShow=!1)})}})},getFloors:function(t,e){var s=this,a={parentId:void 0!==t?t:this.parentCategory.id,pageNum:this.pageNumFloor,pageSize:this.pageSizeFloor};this.$postJson(this._basePath.ajaxCategorySec,a).then(function(a){a.success&&(void 0!==t&&(s.parentCategory={name:e,id:t}),s.secTitle="商品二级分类",s.stallList=a.data.datas,s.totalFloor=a.data.count,s.secShow=!0,s.showStalls=!0,s.showBusiness=!1)})},getStallDetail:function(t){this.isFirstShow=!0,this.showDrawer=!0,this.editForm=r()({},t),this.$set(this.editForm,"categoryId",[t.cParentId,t.cId]),this.options=[{name:t.cParentName,id:t.cParentId,children:[{name:t.name,id:t.cId}]}]},disabledFloor:function(t){var e=this;if(1===t.status){var s=this;this.$confirm("确定禁用该二级分类吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$postJson(e._basePath.ajaxCategoryOperateStatus2,{id:t.id,status:0}).then(function(t){t.success&&(e.$message.success("禁用成功！"),s.getFloors())})})}else this.$postJson(this._basePath.ajaxCategoryOperateStatus2,{id:t.id,status:1}).then(function(t){t.success&&(e.$message.success("启用成功！"),e.getFloors())})},handleEdit:function(t,e){this.dialogStatus="update",this.secShow=!0,this.editForm=r()({},e),this.$set(this.editForm,"categoryId",[e.cParentId,e.cId])},createData:function(){var t=this;this.$refs.editForm.validate(function(e){if(e){var s=r()({},t.editForm);s.cParentId=t.editForm.categoryId[0],s.cId=t.editForm.categoryId[1],s.parentId=t.parentCategory.id,t.$post(t._basePath.ajaxCategorySecEdit,s).then(function(e){e.success&&(t.$message({message:"提交成功",type:"success"}),t.$refs.editForm.resetFields(),t.showDrawer=!1,t.getFloors())})}})},selsChange:function(t){this.sels=t},floorChange:function(t){this.selectArr=t}}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"app-container",attrs:{id:"areaList"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.secShow,expression:"!secShow"}]},[s("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[s("div",{staticClass:"process_btns"},[s("el-button",{attrs:{type:"primary"},on:{click:t.showAddBusiness}},[t._v("新增一级分类")])],1)]),t._v(" "),s("record-count",{attrs:{total:t.total}}),t._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.users,"highlight-current-row":""},on:{"selection-change":t.selsChange}},[s("el-table-column",{attrs:{prop:"id",label:"一级分类ID"}}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"一级分类名称"}}),t._v(" "),s("el-table-column",{attrs:{prop:"orderNum",label:"排序号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"status",label:"状态",formatter:t.formatStatus}}),t._v(" "),s("el-table-column",{attrs:{label:"操作",width:"320px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(s){t.getFloors(e.row.id,e.row.name)}}},[t._v(t._s("其它"!==e.row.name?"设置":"查看")+"二级分类")]),t._v(" "),"其它"!==e.row.name?s("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(s){t.getBusinessDetail(e.row)}}},[t._v("编辑")]):t._e(),t._v(" "),1===e.row.status&&"其它"!==e.row.name?s("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(s){t.disabledArea(e.row)}}},[t._v("禁用")]):t._e(),t._v(" "),0===e.row.status&&"其它"!==e.row.name?s("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:function(s){t.disabledArea(e.row)}}},[t._v("启用")]):t._e()]}}])})],1),t._v(" "),s("div",{staticClass:"page_toolbar"},[s("el-pagination",{attrs:{layout:"prev, pager, next, jumper","prev-text":"上一页","next-text":"下一页",background:"","page-size":t.pageSize,total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),s("Secondary",{attrs:{title:t.secTitle},model:{value:t.secShow,callback:function(e){t.secShow=e},expression:"secShow"}},[t.showStalls?[s("div",{staticClass:"building_title"},[s("i",[t._v("一级分类名称: "+t._s(t.parentCategory.name))])]),t._v(" "),s("div",{staticClass:"process_btns"},["其它"!==t.parentCategory.name?s("el-button",{attrs:{type:"primary"},on:{click:t.showAddStall}},[t._v("新增二级分类")]):t._e()],1),t._v(" "),s("record-count",{attrs:{total:t.totalFloor}}),t._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.stallList,"highlight-current-row":""},on:{"selection-change":t.floorChange}},[s("el-table-column",{attrs:{type:"selection",width:"35px"}}),t._v(" "),s("el-table-column",{attrs:{prop:"id",label:"二级分类ID"}}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"二级分类名称"}}),t._v(" "),s("el-table-column",{attrs:{prop:"img",label:"分类图片"},scopedSlots:t._u([{key:"default",fn:function(t){return[s("img",{attrs:{src:t.row.img,width:"60px",height:"60px"}})]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"orderNum",label:"排序号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"status",label:"状态",formatter:t.formatStatus}}),t._v(" "),s("el-table-column",{attrs:{label:"操作",width:"250px"},scopedSlots:t._u([{key:"default",fn:function(e){return["其它"!==t.parentCategory.name?s("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(s){t.getStallDetail(e.row)}}},[t._v("编辑")]):t._e(),t._v(" "),1===e.row.status&&"其它"!==t.parentCategory.name?s("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(s){t.disabledFloor(e.row)}}},[t._v("禁用")]):t._e(),t._v(" "),0===e.row.status&&"其它"!==t.parentCategory.name?s("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:function(s){t.disabledFloor(e.row)}}},[t._v("启用")]):t._e()]}}])})],1),t._v(" "),s("div",{staticClass:"page_toolbar"},[s("el-pagination",{attrs:{layout:"prev, pager, next, jumper","prev-text":"上一页","next-text":"下一页",background:"","page-size":t.pageSizeFloor,total:t.totalFloor},on:{"current-change":t.handleCurrentChangeFloor}})],1)]:t._e(),t._v(" "),t.showBusiness?[s("el-form",{ref:"businessForm",staticClass:"secondary_form",attrs:{model:t.businessForm,"label-width":"120px",rules:t.businessFormRules}},[s("el-form-item",{attrs:{label:"一级分类名称",prop:"name"}},[s("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入分类名称,名称不能为'其它"},model:{value:t.businessForm.name,callback:function(e){t.$set(t.businessForm,"name",e)},expression:"businessForm.name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"分类序号",prop:"orderNum"}},[s("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入分类序号"},model:{value:t.businessForm.orderNum,callback:function(e){t.$set(t.businessForm,"orderNum",e)},expression:"businessForm.orderNum"}}),t._v("\n               "),s("span",{staticClass:"light_color"},[t._v("(控制分类排序)")])],1),t._v(" "),s("el-form-item",{attrs:{label:"开启状态"}},[s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0},model:{value:t.businessForm.status,callback:function(e){t.$set(t.businessForm,"status",e)},expression:"businessForm.status"}})],1),t._v(" "),s("el-form-item",[s("el-button",{nativeOn:{click:function(e){t.secShow=!1}}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.tradeAreaEdit}},[t._v("保存")])],1)],1)]:t._e()],2),t._v(" "),s("Drawer",{attrs:{title:"编辑二级分类",showFooter:!0},model:{value:t.showDrawer,callback:function(e){t.showDrawer=e},expression:"showDrawer"}},[s("el-form",{ref:"editForm",staticClass:"secondary_form",attrs:{model:t.editForm,"label-width":"120px",rules:t.editFormRules}},[s("el-form-item",{attrs:{label:"所属一级分类"}},[t._v("\n          "+t._s(t.parentCategory.name)+"\n        ")]),t._v(" "),s("el-form-item",{attrs:{label:"二级分类名称",prop:"categoryId"}},[s("el-cascader",{staticClass:"long_input",attrs:{options:t.options,props:t.props},on:{"active-item-change":t.getCategory2,focus:t.getCategory1},model:{value:t.editForm.categoryId,callback:function(e){t.$set(t.editForm,"categoryId",e)},expression:"editForm.categoryId"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"分类序号",prop:"orderNum"}},[s("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"分类序号为数字"},model:{value:t.editForm.orderNum,callback:function(e){t.$set(t.editForm,"orderNum",e)},expression:"editForm.orderNum"}}),t._v("\n            "),s("span",{staticClass:"light_color"},[t._v("(控制分类排序)")])],1),t._v(" "),s("el-form-item",{attrs:{label:"商品类别图",prop:"img"}},[s("good-img-upload",{attrs:{imgUrl_main:t.editForm.img,isGroup:!1,mainTitle:"商品分类图"},on:{uploadImg:t.setImgList}})],1),t._v(" "),s("el-form-item",{attrs:{label:"默认重量",prop:"weight"}},[s("el-input",{attrs:{placeholder:"请输入默认重量"},model:{value:t.editForm.weight,callback:function(e){t.$set(t.editForm,"weight",e)},expression:"editForm.weight"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"开启状态"}},[s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0},model:{value:t.editForm.status,callback:function(e){t.$set(t.editForm,"status",e)},expression:"editForm.status"}})],1)],1),t._v(" "),s("el-button",{attrs:{slot:"footer",type:"primary"},on:{click:t.createData},slot:"footer"},[t._v("保存")])],1)],1)},staticRenderFns:[]};var m=s("VU/8")(u,d,!1,function(t){s("LtSj")},"data-v-77591d69",null);e.default=m.exports},bk6T:function(t,e,s){(t.exports=s("FZ+f")(!1)).push([t.i,"\n#areaList .secondary_form .el-cascader[data-v-77591d69] {\n  width: 100%;\n}\n#areaList .building_title[data-v-77591d69] {\n  margin-top: 10px;\n  margin-bottom: 20px;\n}\n#areaList .building_title i[data-v-77591d69] {\n  font-size: 20px;\n  font-weight: bold;\n}\n#areaList .toolbar_process[data-v-77591d69] {\n  margin-top: 20px;\n}\n",""])}});